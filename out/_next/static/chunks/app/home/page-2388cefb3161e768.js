(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{3668:function(e,r,t){Promise.resolve().then(t.t.bind(t,2452,23)),Promise.resolve().then(t.t.bind(t,9427,23)),Promise.resolve().then(t.t.bind(t,8628,23)),Promise.resolve().then(t.t.bind(t,4738,23)),Promise.resolve().then(t.t.bind(t,3161,23)),Promise.resolve().then(t.t.bind(t,4295,23)),Promise.resolve().then(t.t.bind(t,8606,23)),Promise.resolve().then(t.t.bind(t,2350,23)),Promise.resolve().then(t.t.bind(t,1194,23)),Promise.resolve().then(t.t.bind(t,4143,23)),Promise.resolve().then(t.bind(t,9093)),Promise.resolve().then(t.bind(t,6540)),Promise.resolve().then(t.t.bind(t,1773,23))},9093:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return Maps}});var s=t(7437),n=t(2265),i=t(3198),a=t(8263),c=t(649),o=t(2173),l=t(3903);t(3865);var d=t(1396),h=t.n(d),u=t(6742),p=t(9639),x=t(6716),m=t(1387),f=t(2601);let g=f.env.NEXT_PUBLIC_BACKEND;var marker_with_inwindow=e=>{var r;let{initialPosition:t,Description:d,monitorID:f}=e,[j,v]=(0,n.useState)(!1),[_,y]=(0,c.Rt)(),M=(0,i.I0)(),w=(0,i.v9)(e=>e.records.records.find(e=>e.MonitoringLocationIdentifier===f)),[E,C]=(0,n.useState)("We are asking openai for more information..."),[S,b]=(0,n.useState)(!1),[N,D]=(0,n.useState)(w?w.pH_Value:""),[P,F]=(0,n.useState)(w?w.DO_Value:""),[I,Z]=(0,n.useState)(w?w.NH4N_Value:""),[L,k]=(0,n.useState)(w?w.COD_Value:""),[R,O]=(0,n.useState)(w?w._id:"0");(0,n.useEffect)(()=>{M((0,l.c)())},[M]);let U=(0,i.v9)(e=>e.auth.user),fetchDescription=async e=>{let r=await fetch("".concat(g,"/openai/").concat(e)),t=await r.json();return C(t.data),b(!0),t.data},handleDelete=async()=>{try{let e=await o.Z.delete("".concat(g,"/site/delete"),{data:{MonitoringLocationIdentifier:f}});M((0,a.iT)()),v(!1),console.log("Site deleted successfully:",e.data)}catch(e){alert("Error deleting site:",e.message)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c._Q,{ref:_,onClick:()=>{v(!0),fetchDescription(d).then(e=>console.log(e))},position:t,children:(0,s.jsx)(c.lO,{background:w?(r=w.pH_Value)>=6.5&&r<=7.5?"#00FF00":r>=7.5&&r<8?"#FFFF00":r>=8?"#FF0000":void 0:"#000",glyphColor:"#000",borderColor:"#000",scale:.8})}),j&&(0,s.jsx)(c.nx,{anchor:y,onCloseClick:()=>{v(!1)},children:(0,s.jsxs)("div",{className:"text-start",style:{width:"300px"},children:[(0,s.jsx)("p",{children:d}),w?(0,s.jsx)(m.Z,{striped:!0,bordered:!0,hover:!0,style:{lineHeight:"16px",fontSize:"14px"},children:(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("strong",{children:"pH:"})}),(0,s.jsx)("td",{children:w.pH_Value})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("strong",{children:"DO:"})}),(0,s.jsx)("td",{children:w.DO_Value})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("strong",{children:"NH4N:"})}),(0,s.jsx)("td",{children:w.NH4N_Value})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("strong",{children:"COD:"})}),(0,s.jsx)("td",{children:w.COD_Value})]})]})}):(0,s.jsx)(p.Z,{animation:"border",role:"status",children:(0,s.jsx)("span",{className:"sr-only",children:"Loading..."})}),S?(0,s.jsx)(u.Z,{style:{margin:"10px",fontSize:"16px"},variant:"info",children:(0,s.jsx)("p",{children:E})}):(0,s.jsx)(u.Z,{style:{margin:"10px",fontSize:"16px"},variant:"success",children:(0,s.jsx)("p",{children:E})}),(0,s.jsxs)("div",{className:"action",children:[(0,s.jsx)(x.Z,{variant:"primary",children:(0,s.jsx)(h(),{href:"/tickets",style:{color:"#fff",textDecoration:"none"},children:"Submit a Ticket"})}),U&&"ADMIN"===U.role&&(0,s.jsx)(x.Z,{variant:"danger",onClick:handleDelete,children:"Delete"})]})]})})]})},j=t(2601);function Maps(){let e=(0,i.I0)(),r=(0,i.v9)(e=>e.maps);(0,n.useEffect)(()=>{e((0,a.w6)())},[e]);let t=j.env.NEXT_PUBLIC_GOOGLE;return(0,s.jsx)("div",{className:"maps",style:{height:"100%",width:"100%"},children:(0,s.jsx)(c.un,{apiKey:t,children:(0,s.jsx)(c.D5,{zoom:5,center:{lng:104.153576,lat:30.287459},gestureHandling:"greedy",disableDefaultUI:!0,mapId:"bf51a910020fa25a",children:r.maps&&r.maps.length>0&&r.maps.map((e,r)=>(0,s.jsx)(marker_with_inwindow,{initialPosition:{lat:e.LatitudeMeasure,lng:e.LongitudeMeasure},monitorID:e.MonitoringLocationIdentifier,Description:e.MonitoringLocationDescriptionText},r))})})})}},6540:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return SearchResult}});var s=t(7437),n=t(2402),i=t(7431);function SearchResult(){return(0,s.jsxs)(n.Z,{children:[(0,s.jsx)(n.Z.Item,{children:(0,s.jsxs)("div",{className:"search-item flex flex-wrap d-flex flex-row",children:[(0,s.jsx)("div",{className:"search-icon col-2",children:(0,s.jsx)(i.s8u,{})}),(0,s.jsxs)("div",{className:"search-content col-10",children:[(0,s.jsx)("h4",{children:"Chengdu City"}),(0,s.jsx)("p",{children:"pH: 1, COD:2"}),(0,s.jsxs)("p",{children:[(0,s.jsx)(i.XAC,{})," xx"]})]})]})}),(0,s.jsx)(n.Z.Item,{children:"Dapibus ac facilisis in"})]})}},8263:function(e,r,t){"use strict";t.d(r,{ZP:function(){return maps},iT:function(){return updateFetchMaps},w6:function(){return fetchMaps}});var s=t(2173);t(3198);var n=t(2601);let i=n.env.NEXT_PUBLIC_BACKEND,a="MAPS_REQUEST",c="MAPS_SUCCESS",o="MAPS_FAILURE",requestMaps=()=>({type:a}),receiveMaps=e=>({type:c,maps:e}),mapsError=e=>({type:o,message:e});function maps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,maps:[],errorMessage:""},r=arguments.length>1?arguments[1]:void 0;switch(r.type){case a:return{...e,isFetching:!0,maps:[],errorMessage:""};case c:return{...e,isFetching:!1,maps:r.maps,errorMessage:""};case o:return{...e,isFetching:!1,maps:[],errorMessage:r.message};default:return e}}let fetchMaps=()=>async(e,r)=>{let t=r().maps;if(t.maps.length>0)return t.maps;e(requestMaps());try{let t=await s.Z.get("".concat(i,"/site/all"));return await e(receiveMaps(t.data)),r().maps.maps}catch(r){throw e(mapsError(r.response.data.message)),r}},updateFetchMaps=()=>async(e,r)=>{e(requestMaps());try{let t=await s.Z.get("".concat(i,"/site/all"));return await e(receiveMaps(t.data)),r().maps.maps}catch(r){throw e(mapsError(r.response.data.message)),r}}},3903:function(e,r,t){"use strict";t.d(r,{Z:function(){return records},c:function(){return fetchRecords}});var s=t(2173);t(3198);var n=t(2601);let i=n.env.NEXT_PUBLIC_BACKEND,a="records_REQUEST",c="records_SUCCESS",o="records_FAILURE",requestRecords=()=>({type:a}),receiveRecords=e=>({type:c,records:e}),recordsError=e=>({type:o,message:e});function records(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,records:[],errorMessage:""},r=arguments.length>1?arguments[1]:void 0;switch(r.type){case a:return{...e,isFetching:!0,records:[],errorMessage:""};case c:return{...e,isFetching:!1,records:r.records,errorMessage:""};case o:return{...e,isFetching:!1,records:[],errorMessage:r.message};default:return e}}let fetchRecords=()=>async(e,r)=>{let{isFetching:t,records:n}=r().records;if(t||n.length>0)return n;e(requestRecords());try{let r=await s.Z.get("".concat(i,"/record/all/latest/"));return e(receiveRecords(r.data)),r.data}catch(r){throw e(recordsError(r.response.data.message)),r}}},3865:function(){},1773:function(){}},function(e){e.O(0,[982,126,198,396,680,498,526,971,864,744],function(){return e(e.s=3668)}),_N_E=e.O()}]);